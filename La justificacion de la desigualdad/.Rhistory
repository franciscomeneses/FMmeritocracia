f.per_mer =~ f.des.ads + f.per_mer
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
#Sx no afecta
#pospol no afecta
#f.salir_adel_mer no es afectado
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer =~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
summary(fit3, fit.measures=T, standardized=T)
#Sx no afecta
#pospol no afecta
#f.salir_adel_mer no es afectado
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
summary(fit3, fit.measures=T, standardized=T)
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
summary(fit3, fit.measures=T, standardized=T)
pob_b<-read_spss("pob_05netquest.sav")
pob_mb=pob_b %>% select( ingresos, educat,
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"para_surguir_fam.ric"=get_ah_1,
"para_surguir_pa.educ"=get_ah_2,
"perc_sal.adel_bue.cont"=merit_perc_pref_4,
"para_surguir_ten.educ"=get_ah_3,
"para_surguir_ten.ambi"=get_ah_4,
"para_surguir_trab.duro"=get_ah_5,"con.per.ad"=get_ahB_1, "cn.pol"=get_ahB_2, "pg.coim"=get_ahB_3, "raza"=get_ahB_4, "relig"=get_ahB_5,"sx"=sexo, "sexo"=get_ahB_6) %>% as.data.frame()
pob_b <- pob_b %>% select("con.per.ad"=get_ahB_1, "cn.pol"=get_ahB_2, "pg.coim"=get_ahB_3, "raza"=get_ahB_4, "relig"=get_ahB_5, "sexo"=get_ahB_6)
pob_mb<-na.omit(pob_mb)
pob_b<-na.omit(pob_b)
Modelo_sem_c <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.rel_desop =~ para_surguir_fam.ric + para_surguir_pa.educ
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.rel_desop + f.des.ads + f.des.redes
'
fit4<- sem(Modelo_sem_c, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
fit4<- sem(Modelo_sem_c, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento","para_surguir_fam.ric", "para_surguir_pa.educ"))
Modelo_sem_c <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.rel_desop =~ para_surguir_fam.ric + para_surguir_pa.educ
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.rel_desop + f.des.ads + f.des.redes
'
fit4<- sem(Modelo_sem_c, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento","para_surguir_fam.ric", "para_surguir_pa.educ"))
summary(fit4, fit.measures=T, standardized=T)
modificationindices(fit4)
Modelo_sem_c <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento + para_surguir_fam.ric
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit4<- sem(Modelo_sem_c, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento","para_surguir_fam.ric", "para_surguir_pa.educ"))
summary(fit4, fit.measures=T, standardized=T)
modificationindices(fit3)
#lo que provoca el desajuste segun el indices modification es la correlacion no explicitada entre ads y redes.
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~~.des.redes
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
#lo que provoca el desajuste segun el indices modification es la correlacion no explicitada entre ads y redes.
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~~ f.des.redes
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
summary(fit3, fit.measures=T, standardized=T)
#lo que provoca el desajuste segun el indices modification es la correlacion no explicitada entre ads y redes.
Modelo_sem_b <-
'f.des.redes =~ con.per.ad + cn.pol +  pg.coim + perc_sal.adel_bue.cont
f.des.ads =~ raza + relig + sexo
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.des.ads ~~ f.des.redes
f.des.ads ~ ingresos + sx
f.des.redes ~ educat + ingresos
f.per_mer ~ f.des.ads + f.des.redes
'
fit3<- sem(Modelo_sem_b, data=pob_mb,  ordered = c("con.per.ad", "cn.pol", "pg.coim", "raza", "relig", "sexo", "sx", "perc_sal.adel_bue.cont","perc_recom_esfuerzo", "perc_recom_talento"))
summary(fit3, fit.measures=T, standardized=T)
modificationindices(fit3)
pacman::p_load(poLCA,
psych,
foreign,
gdata, # rename vars
stargazer,
xtable,
lavaan,
vcd,
vcdExtra,
readstata13,
skimr,
ggplot2,
sjPlot,
sjmisc)
library(haven)
library(dplyr)
knitr::opts_chunk$set(echo = TRUE)
f1<-fa(pob_per, factor = 1)
pacman::p_load(psych,haven,dplyr,car,likert,reshape, lavaan, corrplot, semPlot, stargazer)
f1<-fa(pob_per, factor = 1)
f1
f1<-factanal(pob_per, factor = 1)
f1
fa(pob_per, nfactors= 4, rotate="oblimin", scores="regression",
residuals=FALSE, SMC=TRUE, covar=FALSE,missing=FALSE,impute="median",
min.err = 0.001,  max.iter = 50,symmetric=TRUE, warnings=TRUE, fm="minres",
alpha=.1,p=.05,oblique.scores=FALSE,np.obs=NULL,use="pairwise",cor="cor",
correct=.5,weight=NULL)
fa(pob_per, nfactors= 4, rotate="GPArotation", scores="regression",
residuals=FALSE, SMC=TRUE, covar=FALSE,missing=FALSE,impute="median",
min.err = 0.001,  max.iter = 50,symmetric=TRUE, warnings=TRUE, fm="minres",
alpha=.1,p=.05,oblique.scores=FALSE,np.obs=NULL,use="pairwise",cor="cor",
correct=.5,weight=NULL)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(psych,haven,dplyr,car,likert,reshape, lavaan, corrplot, semPlot, stargazer)
pob <- read_spss("pob_05netquest.sav")
pob_recb=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_recb<-na.omit(pob_recb)
pob_rec=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"perc_sal.adel_padr.ric"=merit_perc_pref_3,
"perc_sal.adel_bue.cont"=merit_perc_pref_4,
"para_surguir_fam.ric"=get_ah_1,
"para_surguir_pa.educ"=get_ah_2,
"para_surguir_ten.educ"=get_ah_3,
"para_surguir_ten.ambi"=get_ah_4,
"para_surguir_trab.duro"=get_ah_5,
"norm_recom_esfuerzo"=merit_perc_pref_5,
"norm_recom_talento"=merit_perc_pref_13,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_rec$pos_pol_1[pob_rec$pos_pol_1 ==-99]<-NA
pob_rec<-na.omit(pob_rec) #quedan 894 casos
pob_per=pob_rec %>% select(  #Base recortada con preguntas de percepcion de meritocracia.
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro) %>% as.data.frame()
pob_norm=pob_rec %>% select(  #Base recortada con preguntas de opinion de meritocracia.
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per_norm =pob_rec %>% select( #Base pob_per + Base pob_norm
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro,
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per<-na.omit(pob_per) #quedan 894 casos
pob_norm<-na.omit(pob_norm) #quedan 894 casos
pob_per_norm<-na.omit(pob_per_norm) #quedan 894 casos
remove(pob)
stargazer(pob_rec, type = "text")
pob_per[1:4] <-lapply(pob_per[1:4],factor, levels = 1:5)
likt <- likert(pob_per)
plot(likt)
pob_norm[,1:4] <-lapply(pob_norm[,1:4],factor, levels=1:5)
likt3 <- likert(pob_norm)
plot(likt3)
pcor_mer <-polychoric(pob_per,smooth=TRUE,global=TRUE,polycor=FALSE, ML = FALSE,
std.err=FALSE,weight=NULL,progress=TRUE,na.rm=TRUE, delete=TRUE)
corrplot.mixed(pcor_mer$rho,tl.pos = c("d"), diag = c("u"))
pcor_norm<-polychoric(pob_norm,smooth=TRUE,global=TRUE,polycor=FALSE, ML = FALSE,
std.err=FALSE,weight=NULL,progress=TRUE,na.rm=TRUE, delete=TRUE)
corrplot.mixed(pcor_norm$rho,tl.pos = c("d"), diag = c("u"))
f1<-factanal(pob_per, factor = 1)
pob <- read_spss("pob_05netquest.sav")
pob_recb=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_recb<-na.omit(pob_recb)
pob_rec=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"perc_sal.adel_padr.ric"=merit_perc_pref_3,
"perc_sal.adel_bue.cont"=merit_perc_pref_4,
"para_surguir_fam.ric"=get_ah_1,
"para_surguir_pa.educ"=get_ah_2,
"para_surguir_ten.educ"=get_ah_3,
"para_surguir_ten.ambi"=get_ah_4,
"para_surguir_trab.duro"=get_ah_5,
"norm_recom_esfuerzo"=merit_perc_pref_5,
"norm_recom_talento"=merit_perc_pref_13,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_rec$pos_pol_1[pob_rec$pos_pol_1 ==-99]<-NA
pob_rec<-na.omit(pob_rec) #quedan 894 casos
pob_per=pob_rec %>% select(  #Base recortada con preguntas de percepcion de meritocracia.
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro) %>% as.data.frame()
pob_norm=pob_rec %>% select(  #Base recortada con preguntas de opinion de meritocracia.
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per_norm =pob_rec %>% select( #Base pob_per + Base pob_norm
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro,
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per<-na.omit(pob_per) #quedan 894 casos
pob_norm<-na.omit(pob_norm) #quedan 894 casos
pob_per_norm<-na.omit(pob_per_norm) #quedan 894 casos
remove(pob)
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(psych,haven,dplyr,car,likert,reshape, lavaan, corrplot, semPlot, stargazer)
pob <- read_spss("pob_05netquest.sav")
pob_recb=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_recb<-na.omit(pob_recb)
pob_rec=pob %>% select(
"perc_recom_esfuerzo"=merit_perc_pref_1,
"perc_recom_talento"=merit_perc_pref_2,
"perc_sal.adel_padr.ric"=merit_perc_pref_3,
"perc_sal.adel_bue.cont"=merit_perc_pref_4,
"para_surguir_fam.ric"=get_ah_1,
"para_surguir_pa.educ"=get_ah_2,
"para_surguir_ten.educ"=get_ah_3,
"para_surguir_ten.ambi"=get_ah_4,
"para_surguir_trab.duro"=get_ah_5,
"norm_recom_esfuerzo"=merit_perc_pref_5,
"norm_recom_talento"=merit_perc_pref_13,
"norm_sal.adel_padr.ric"=merit_perc_pref_14,
"norm_sal.adel_bue.cont"=merit_perc_pref_15,
"t_trat"= FL_9_DO_Tratamiento,
"t_con"=FL_9_DO_Control,
"t_des"=FL_9_DO_Tratamiento_desigualdad,
egal_1,egal_2,egal_3,egal_4,egal_5,egal_6,egal_7, egal_8,
pos_pol_1) %>% as.data.frame()
pob_rec$pos_pol_1[pob_rec$pos_pol_1 ==-99]<-NA
pob_rec<-na.omit(pob_rec) #quedan 894 casos
pob_per=pob_rec %>% select(  #Base recortada con preguntas de percepcion de meritocracia.
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro) %>% as.data.frame()
pob_norm=pob_rec %>% select(  #Base recortada con preguntas de opinion de meritocracia.
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per_norm =pob_rec %>% select( #Base pob_per + Base pob_norm
perc_recom_esfuerzo,
perc_recom_talento,
perc_sal.adel_padr.ric,
perc_sal.adel_bue.cont,
para_surguir_fam.ric,
para_surguir_pa.educ,
para_surguir_ten.educ,
para_surguir_ten.ambi,
para_surguir_trab.duro,
norm_recom_esfuerzo,
norm_recom_talento,
norm_sal.adel_padr.ric,
norm_sal.adel_bue.cont) %>% as.data.frame()
pob_per<-na.omit(pob_per) #quedan 894 casos
pob_norm<-na.omit(pob_norm) #quedan 894 casos
pob_per_norm<-na.omit(pob_per_norm) #quedan 894 casos
remove(pob)
stargazer(pob_rec, type = "text")
pob_per[1:4] <-lapply(pob_per[1:4],factor, levels = 1:5)
likt <- likert(pob_per)
plot(likt)
pob_norm[,1:4] <-lapply(pob_norm[,1:4],factor, levels=1:5)
likt3 <- likert(pob_norm)
plot(likt3)
pcor_mer <-polychoric(pob_per,smooth=TRUE,global=TRUE,polycor=FALSE, ML = FALSE,
std.err=FALSE,weight=NULL,progress=TRUE,na.rm=TRUE, delete=TRUE)
corrplot.mixed(pcor_mer$rho,tl.pos = c("d"), diag = c("u"))
pcor_norm<-polychoric(pob_norm,smooth=TRUE,global=TRUE,polycor=FALSE, ML = FALSE,
std.err=FALSE,weight=NULL,progress=TRUE,na.rm=TRUE, delete=TRUE)
corrplot.mixed(pcor_norm$rho,tl.pos = c("d"), diag = c("u"))
f1<-factanal(pob_per, factor = 1)
f1<-factanal(pob_per, factor = 1)
f1<-fa(pob_per, factor = 1)
?fa
?fa
f1<-fa.poly(pob_per, factor = 1)
?fa
f1<-fac(pob_per, factor = 1)
f1<-fa.sapa(pob_per, factor = 1)
pacman::p_load(psych,haven,dplyr,car,likert,reshape, lavaan, corrplot, semPlot, stargazer)
?fa
f1<-fa(pob_per, factor = 1)
pob_norm[,1:4] <-lapply(pob_norm[,1:4],factor, levels=1:5)
likt3 <- likert(pob_norm)
plot(likt3)
factanal(pob_per, nfactors= 4, rotate="oblimin", scores="regression",
residuals=FALSE, SMC=TRUE, covar=FALSE,missing=FALSE,impute="median",
min.err = 0.001,  max.iter = 50,symmetric=TRUE, warnings=TRUE, fm="minres",
alpha=.1,p=.05,oblique.scores=FALSE,np.obs=NULL,use="pairwise",cor="cor",
correct=.5,weight=NULL)
?fa
f1<-fa(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
?fa
f1<-fa(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
?fa
f1<-factanal(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
?fa
f1<-fa(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
?fa
f1<-fa(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
?fa
f1<-fa(pob_per, factor = 1, ordered = c("perc_recom_esfuerzo","perc_recom_talento","perc_sal.adel_padr.ric", "perc_sal.adel_bue.cont", "para_surguir_fam.ric", "para_surguir_pa.educ", "para_surguir_ten.ambi", "norm_recom_esfuerzo","norm_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "para_surguir_trab.duro"))
model_13<- '
f.egal=~ egal_1 + egal_2 + egal_3 + egal_4 + egal_5 + egal_6 + egal_7 + egal_8
'
fit_13<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" ,  "egal_4", "egal_5", "egal_6", "egal_7", "egal_8"))
model_13<- '
f.egal=~ egal_1 + egal_2 + egal_3 + egal_4 + egal_5 + egal_6 + egal_7 + egal_8
'
fit_13<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" , "egal_3"  "egal_4", "egal_5", "egal_6", "egal_7", "egal_8"))
model_13<- '
f.egal=~ egal_1 + egal_2 + egal_3 + egal_4 + egal_5 + egal_6 + egal_7 + egal_8
'
fit_13<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" , "egal_3" , "egal_4", "egal_5", "egal_6", "egal_7", "egal_8"))
summary(fit_13, fit.measures=T, standardized=T)
model_14<- '
f.egal=~ egal_1 + egal_2 + egal_4 + egal_5 + egal_6
'
fit_14<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" ,  "egal_4", "egal_5", "egal_6"))
model_14<- '
f.egal=~ egal_1 + egal_2 + egal_4 + egal_5 + egal_6
'
fit_14<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" , "egal_4", "egal_5", "egal_6"))
model_13<- '
f.egal=~ egal_1 + egal_2 + egal_3 + egal_4 + egal_5 + egal_6 + egal_7 + egal_8
'
fit_13<- cfa(model_13, data=pob_rec, ordered= c("egal_1", "egal_2" , "egal_3" , "egal_4", "egal_5", "egal_6", "egal_7", "egal_8"))
summary(fit_13, fit.measures=T, standardized=T)
model_14<- 'f.egal=~ egal_1 + egal_2 + egal_4 + egal_5 + egal_6'
fit_14<- cfa(model_14, data=pob_rec, ordered= c("egal_1", "egal_2" , "egal_4", "egal_5", "egal_6"))
summary(fit_14, fit.measures=T, standardized=T)
#se excluye egal4 por crossloading
#se excluye egal 3 7 8 por que relacionan menos
model_7<- '
f.per_mer =~ perc_recom_esfuerzo + perc_recom_talento
f.norm_desop =~ norm_sal.adel_padr.ric + norm_sal.adel_bue.cont
f.egal=~ egal_1 + egal_2 + egal_5 + egal_6
f.per_mer ~ t_des
f.norm_desop ~ a*f.per_mer
f.egal ~ b*f.norm_desop
ind_mer_egal:= a*b
'
fit_7<- sem(model_7, data=pob_recb, ordered =c("perc_recom_esfuerzo", "perc_recom_talento", "norm_sal.adel_padr.ric", "norm_sal.adel_bue.cont", "egal_1", "egal_2",  "egal_4", "egal_5", "egal_6"))
summary(fit_7, fit.measures=T, standardized=T )
pacman::p_load(poLCA,
psych,
foreign,
gdata, # rename vars
stargazer,
xtable,
lavaan,
vcd,
vcdExtra,
readstata13,
skimr,
ggplot2,
sjPlot,
sjmisc)
library(haven)
library(dplyr)
pacman::p_load(poLCA,
psych,
foreign,
gdata, # rename vars
stargazer,
xtable,
lavaan,
vcd,
vcdExtra,
readstata13,
skimr,
ggplot2,
sjPlot,
sjmisc)
library(haven)
library(dplyr)
pacman::p_load(poLCA,
psych,
foreign,
gdata, # rename vars
stargazer,
xtable,
lavaan,
vcd,
vcdExtra,
readstata13,
skimr,
ggplot2,
sjPlot,
sjmisc)
library(haven)
library(dplyr)
pob <- read_spss("pob_05netquest.sav")
pob_mer=pob %>% select(
"esfuerzo"= merit_perc_pref_1,
"talento" = merit_perc_pref_2,
"padres_pudientes"=merit_perc_pref_3,
"contactos"=merit_perc_pref_4) %>% as.data.frame()
